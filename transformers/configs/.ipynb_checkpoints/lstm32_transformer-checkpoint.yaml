# configs/lstm32_tx.yaml
# LSTM32+TX: Best performing model from Ruiru et al. (2024)
# Achieved 95.9% accuracy on CF Industries with 301,554 parameters

model:
  name: lstm32_tx
  n_features: 8  # Will be set dynamically
  lstm_units: 32  # Single LSTM layer with 32 units
  d_model: 64
  n_heads: 4
  n_transformer_blocks: 4  # 4 transformer blocks as per paper
  d_ff: 256
  dropout: 0.1

data:
  path: ../data.csv
  train_months: 8
  val_months: 1
  test_month: 1
  test_year: 2023
  
  # Sequence parameters optimized for options
  seq_len: 15
  label_len: 3
  pred_len: 1
  
  # Sequential mode with lifecycle grouping
  sequential: true
  group_by: ["STRIKE", "MONEYNESS_BUCKET"]
  min_chain_length: 18
  stratify_by_horizon: true
  
  # Features with lifecycle information
  feature_columns:
    - STRIKE
    - UNDERLYING_LAST
    - MTM
    - RFR
    - VOL_GG
    - DTE
    - DTE_NORMALIZED
    - MONEYNESS
  
  target_column: C_MID

training:
  batch_size: 64
  learning_rate: 0.0001
  weight_decay: 0.0001
  epochs: 100
  early_stopping_patience: 20
  grad_clip: 1.0
  optimizer: adam
  
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 10
    min_lr: 1.0e-6

hardware:
  num_workers: 4
  pin_memory: true
  seed: 42

output:
  save_dir: ./results/lstm32_tx
  log_interval: 100
